<div class="example-container">
  <!-- Header Section -->
  <header class="app-header">
    <div class="header-content">
      <h1 class="header-title">
        <span class="title-icon">🧮</span>
        MathJax + Angular 19 Integration
      </h1>
      <p class="header-subtitle">
        Seamlessly combine LaTeX mathematics with dynamic Angular components
      </p>

      <div class="header-stats">
        <div class="stat-item">
          <span class="stat-label">Components</span>
          <span class="stat-value">{{ totalComponents() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Math Expressions</span>
          <span class="stat-value">{{ totalMathExpressions() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Processing Time</span>
          <span class="stat-value">{{ averageProcessingTime() }}ms</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Global Controls -->
  <div class="global-controls">
    <div class="controls-section">
      <h3>Global Settings</h3>
      <div class="control-grid">
        <button
          (click)="refreshAllContent()"
          class="global-btn primary"
          [disabled]="isProcessing()">
          <span class="btn-icon">🔄</span>
          Refresh All
        </button>

        <button
          (click)="toggleGlobalTheme()"
          class="global-btn secondary">
          <span class="btn-icon">{{ isDarkTheme ? '☀️' : '🌙' }}</span>
          {{ isDarkTheme ? 'Light' : 'Dark' }} Theme
        </button>

        <button
          (click)="toggleComponentsGlobally()"
          class="global-btn accent">
          <span class="btn-icon">{{ globalComponentsEnabled ? '🔒' : '⚛️' }}</span>
          {{ globalComponentsEnabled ? 'Disable' : 'Enable' }} Components
        </button>

        <button
          (click)="exportContent()"
          class="global-btn info">
          <span class="btn-icon">📄</span>
          Export Content
        </button>
      </div>
    </div>

    <div class="status-section">
      <div class="status-indicator" [ngClass]="globalStatusClass()">
        <span class="status-icon">{{ globalStatusIcon() }}</span>
        <span class="status-text">{{ globalStatus() }}</span>
      </div>
    </div>
  </div>

  <!-- Content Sections -->
  <div class="content-sections">
    <section
      *ngFor="let section of sections; trackBy: trackSection"
      class="example-section"
      [attr.data-section]="section.id">

      <div class="section-header">
        <div class="section-title-group">
          <span class="section-icon">{{ section.icon }}</span>
          <div class="section-text">
            <h2 class="section-title">{{ section.title }}</h2>
            <p class="section-description">{{ section.description }}</p>
          </div>
        </div>

        <div class="section-controls">
          <div class="processing-indicator"
               *ngIf="sectionProcessing.has(section.id)"
               [ngClass]="{ 'active': sectionProcessing.get(section.id) }">
            <div class="processing-spinner"></div>
          </div>

          <button
            (click)="refreshSection(section.id)"
            class="section-btn"
            [disabled]="sectionProcessing.get(section.id)"
            title="Refresh this section">
            <span class="btn-icon">🔄</span>
          </button>
        </div>
      </div>

      <div class="section-content">
        <app-mathjax-content
          [content]="section.content"
          [enableDynamicComponents]="(section.options?.enableDynamicComponents ?? true) && globalComponentsEnabled"
          [showControls]="section.options?.showControls ?? true"
          [containerClass]="getContainerClass(section)"
          (contentProcessed)="onSectionProcessed(section.id)"
          (componentCreated)="onComponentCreated($event, section.id)"
          (processingStateChange)="onProcessingStateChange($event, section.id)"
          (errorOccurred)="onSectionError($event, section.id)">
        </app-mathjax-content>
      </div>
    </section>
  </div>

  <!-- Interactive Demo Section -->
  <section class="interactive-demo-section">
    <div class="section-header">
      <div class="section-title-group">
        <span class="section-icon">🎮</span>
        <div class="section-text">
          <h2 class="section-title">Real-time Interactive Demo</h2>
          <p class="section-description">
            Dynamically update mathematical content and see changes instantly
          </p>
        </div>
      </div>
    </div>

    <div class="demo-controls">
      <div class="demo-control-group">
        <label class="demo-label">Equation Type:</label>
        <select [(ngModel)]="demoEquationType" (ngModelChange)="updateDemoContent()" class="demo-select">
          <option value="linear">Linear Function</option>
          <option value="quadratic">Quadratic Function</option>
          <option value="trigonometric">Trigonometric Function</option>
          <option value="exponential">Exponential Function</option>
          <option value="logarithmic">Logarithmic Function</option>
        </select>
      </div>

      <div class="demo-control-group">
        <label class="demo-label">Parameter A: {{ demoParamA }}</label>
        <input
          type="range"
          [(ngModel)]="demoParamA"
          (ngModelChange)="updateDemoContent()"
          min="-5"
          max="5"
          step="0.1"
          class="demo-slider">
      </div>

      <div class="demo-control-group">
        <label class="demo-label">Parameter B: {{ demoParamB }}</label>
        <input
          type="range"
          [(ngModel)]="demoParamB"
          (ngModelChange)="updateDemoContent()"
          min="-10"
          max="10"
          step="0.1"
          class="demo-slider">
      </div>

      <div class="demo-actions">
        <button (click)="randomizeDemoParams()" class="demo-btn accent">
          🎲 Randomize
        </button>
        <button (click)="resetDemoParams()" class="demo-btn secondary">
          ↻ Reset
        </button>
      </div>
    </div>

    <div class="demo-content">
      <app-mathjax-content
        #demoContent
        [content]="demoMathContent()"
        [enableDynamicComponents]="true"
        [showControls]="true"
        [containerClass]="getDemoContainerClass()"
        (contentProcessed)="onDemoProcessed()"
        (componentCreated)="onDemoComponentCreated($event)">
      </app-mathjax-content>
    </div>
  </section>

  <!-- Performance Metrics -->
  <section class="metrics-section" *ngIf="showMetrics">
    <h3>Performance Metrics</h3>
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value">{{ processingTimes.length }}</div>
        <div class="metric-label">Total Renders</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{ fastestRender }}ms</div>
        <div class="metric-label">Fastest Render</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{ slowestRender }}ms</div>
        <div class="metric-label">Slowest Render</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{ componentsCreated }}</div>
        <div class="metric-label">Components Created</div>
      </div>
    </div>
  </section>

  <div #quickExample class="sample_output" [innerHTML]="safe_content"></div>

  <!-- Footer -->
  <footer class="app-footer">
    <div class="footer-content">
      <p class="footer-text">
        Built with <strong>Angular 19</strong> + <strong>MathJax 3</strong> + <strong>Standalone Components</strong>
      </p>
      <div class="footer-links">
        <button (click)="toggleMetrics()" class="footer-link">
          {{ showMetrics ? 'Hide' : 'Show' }} Metrics
        </button>
        <button (click)="downloadLogs()" class="footer-link">
          Download Logs
        </button>
        <button (click)="resetAllData()" class="footer-link">
          Reset All
        </button>
      </div>
    </div>
  </footer>
</div>
